{"mappings":"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","sources":["js/flowerManager.js"],"sourcesContent":["const { random, PI, sin, cos, round, floor, ceil, min, max } = Math;\r\n\r\nfunction throttle(fn, threshhold, scope) {\r\n  threshhold || (threshhold = 300);\r\n  var last,\r\n      deferTimer;\r\n  return function () {\r\n    var context = scope || this;\r\n\r\n    var now = +new Date,\r\n        args = arguments;\r\n    if (last && now < last + threshhold) {\r\n      clearTimeout(deferTimer);\r\n      deferTimer = setTimeout(function () {\r\n        last = now;\r\n        fn.apply(context, args);\r\n      }, threshhold);\r\n    } else {\r\n      last = now;\r\n      fn.apply(context, args);\r\n    }\r\n  };\r\n}\r\n\r\nfunction rnd(min, max) {\r\n  if (max === undefined) { max = min; min = 0; }\r\n  return random() * (max - min) + min;\r\n}\r\n\r\nfunction rndInt(min, max) {\r\n  if (max === undefined) { max = min; min = 0; }\r\n  min = ceil(min);\r\n  max = floor(max);\r\n  return floor(random() * (max - min)) + min;\r\n}\r\n\r\n\r\nfunction fillCanvas() {\r\n  const svg = document.getElementById('flowerCanvas');\r\n  let width, height, cx, cy;\r\n\r\n  let zoom = 100;\r\n  let vbOX = 0;\r\n  let vbOY = 0;\r\n\r\n  init();\r\n\r\n  function init() {\r\n    onResize();\r\n    initEventHandlers();\r\n  }\r\n  \r\n\r\n  function initEventHandlers() {\r\n    window.addEventListener('resize', onResize);\r\n    document.body.addEventListener('mousemove',   throttle(newFlower));\r\n  }\r\n\r\n  function newFlower(e) {\r\n    createFlower({\r\n      x: e.clientX - cx,\r\n      y: e.clientY - cy,\r\n    });\r\n    \r\n  }\r\n  \r\n  function createFlower(params) {\r\n    const iRadiusCoef = rnd(5, 7);\r\n    const oRadiusCoef = rnd(iRadiusCoef, 10);\r\n    new Flower({\r\n      parent: svg,\r\n      petals: rndInt(4, 12),\r\n      rings: rndInt(6, 8),\r\n      step: rndInt(10, 12),\r\n      alpha: 1,\r\n      angle: rnd(PI),\r\n      iRadius: rnd(1, 6),\r\n      iRadiusCoef,\r\n      oRadius: rnd(5, 10),\r\n      oRadiusCoef,\r\n      ...params\r\n    });\r\n  }\r\n\r\n  function onResize() {\r\n    const r = svg.getBoundingClientRect();\r\n    width = r.width;\r\n    height = r.height;\r\n    cx = width / 2;\r\n    cy = height / 2;\r\n    updateViewBox();\r\n  }\r\n\r\n  function updateViewBox() {\r\n    const vbW = (width * 100) / zoom;\r\n    const vbH = (height * 100) / zoom;\r\n    const vbX = vbOX - vbW / 2;\r\n    const vbY = vbOY - vbH / 2;\r\n    svg.setAttribute('viewBox', `${vbX} ${vbY} ${vbW} ${vbH}`);\r\n  }\r\n}\r\n\r\nclass Flower {\r\n  constructor(conf) {\r\n    this.conf = {\r\n      alpha: 1,\r\n      angle: rnd(0,90),\r\n      iRadius: 2, iRadiusCoef: 5,\r\n      oRadius: 5, oRadiusCoef: 10,\r\n      layerAnim: 'layerAnim',\r\n      reverseDelay: 1 > 0.5,\r\n      ...conf\r\n    };\r\n    this.create();\r\n  }\r\n  create() {\r\n    let { parent, x, y, petals, rings, step, colors, alpha, angle, iRadius, iRadiusCoef, oRadius, oRadiusCoef, layerAnim, reverseDelay } = this.conf;\r\n\r\n    this.group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\r\n    this.group.classList.add('flower');\r\n    parent.appendChild(this.group);\r\n\r\n    if (!colors) {\r\n      colors = [chroma.random(), chroma.random()];\r\n      if (rings > 6) colors.push(chroma.random());\r\n    }\r\n\r\n    const cscale = chroma.scale(colors);\r\n    let layer, np, color, di;\r\n    for (let i = rings; i > 0; i--) {\r\n      layer = document.createElementNS('http://www.w3.org/2000/svg', 'g');\r\n      layer.classList.add('layer');\r\n\r\n      np = floor((i + step - 1) / step) * petals;\r\n      color = cscale(i * 1 / rings).alpha(alpha);\r\n      this.createPetalsRing(layer, x, y, np, iRadius + i * iRadiusCoef, oRadius + i * oRadiusCoef, angle + i % 2 * PI / np, color);\r\n\r\n      di = reverseDelay ? (rings - i + 1) : i;\r\n      layer.style.animationName = layerAnim;\r\n      layer.style.animationDuration = (rings * 0.3) + 's';\r\n      layer.style.animationDelay = (di * 0.15) + 's';\r\n      this.group.appendChild(layer);\r\n    }\r\n  }\r\n  createPetalsRing(parent, x, y, n, iRadius, oRadius, angle, fill) {\r\n    const da = 2 * PI / n;\r\n    const dr = oRadius - iRadius;\r\n    const cpda = rnd(0.5 * da / 5, 1.5 * da / 5);\r\n    const cpdr = rnd(dr * 0.25, dr * 1.1);\r\n    let a;\r\n    for (let i = 0; i < n; i++) {\r\n      a = angle + i * da;\r\n      new Petal({\r\n        parent,\r\n        x, y,\r\n        startA: a,\r\n        endA: a + da,\r\n        iRadius,\r\n        oRadius,\r\n        cpda,\r\n        cpdr,\r\n        fill,\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nclass Petal {\r\n  constructor({ parent, x, y, startA, endA, iRadius, oRadius, cpda, cpdr, fill }) {\r\n    this.parent = parent;\r\n    this.fill = fill;\r\n\r\n    const da = endA - startA;\r\n    const iRadius0 = iRadius / 5;\r\n    this.sp = [x + cos(startA + da / 2) * iRadius0, y + sin(startA + da / 2) * iRadius0];\r\n    this.cp1 = [x + cos(startA - cpda) * (iRadius + cpdr), y + sin(startA - cpda) * (iRadius + cpdr)];\r\n    this.cp2 = [x + cos(endA + cpda) * (iRadius + cpdr), y + sin(endA + cpda) * (iRadius + cpdr)];\r\n    this.ep = [x + cos(startA + da / 2) * oRadius, y + sin(startA + da / 2) * oRadius];\r\n\r\n    this.curve1 = new QCurve({ sp: this.sp, cp: this.cp1, ep: this.ep });\r\n    this.curve2 = new QCurve({ sp: this.sp, cp: this.cp2, ep: this.ep });\r\n    this.create();\r\n  }\r\n  create() {\r\n    this.path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n    this.path.setAttribute('d', this.pathD());\r\n    this.path.style.fill = this.fill;\r\n    this.parent.appendChild(this.path);\r\n  }\r\n  pathD() {\r\n    return [\r\n      this.curve1.pathD(),\r\n      this.curve2.pathD(),\r\n    ].join(' ');\r\n  }\r\n}\r\n\r\nclass QCurve {\r\n  constructor({ sp, cp, ep }) {\r\n    this.sp = sp;\r\n    this.cp = cp;\r\n    this.ep = ep;\r\n  }\r\n  pathD() {\r\n    return [\r\n      `M${this.sp[0]} ${this.sp[1]}`,\r\n      `Q${this.cp[0]} ${this.cp[1]}`,\r\n      `${this.ep[0]} ${this.ep[1]}`,\r\n    ].join(' ');\r\n  }\r\n}\r\n\r\n\r\nfillCanvas();"],"names":[],"version":3,"file":"index.ed73ba1b.js.map","sourceRoot":"/__parcel_source_root/"}